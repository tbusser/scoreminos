(()=>{"use strict";(()=>{function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.steps=e,this.config=t,this.setup()}var r,i;return r=n,(i=[{key:"activeIndex",get:function(){var e,t=this;return null===(e=this.steps)||void 0===e?void 0:e.findIndex((function(e){return e.id===t.activeStepId}))}},{key:"activateStep",value:function(e){var t;this.setVisibility(e,!0),this.activeStepId=e.id,null===(t=this.config.onInstanceActivated)||void 0===t||t.call(this,e)}},{key:"deactivateStep",value:function(e){this.setVisibility(e,!1)}},{key:"getInstance",value:function(e){return e.instance||(e.instance=this.config.instanceFactory(e.id)),e.instance}},{key:"setup",value:function(){var t,n,r=(t=this.steps,n=1,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];this.activateStep(r)}},{key:"setVisibility",value:function(e,t){var n=this.getInstance(e);return!!n&&(n.isVisible=t,!0)}},{key:"goBack",value:function(){var e=this.activeIndex;void 0!==e&&0!==e&&(this.deactivateStep(this.steps[e]),this.activateStep(this.steps[e-1]))}},{key:"goForward",value:function(){var e=this.activeIndex;void 0!==e&&e!==this.steps.length-11&&(this.deactivateStep(this.steps[e]),this.activateStep(this.steps[e+1]))}},{key:"goTo",value:function(e){var t=this.steps.find((function(t){return t.id===e}));void 0!==t&&(this.deactivateStep(this.steps[this.activeIndex]),this.activateStep(t))}}])&&t(r.prototype,i),n}();function r(e,t,n){if(!n||"function"!=typeof n.value)throw new TypeError("Only methods can be decorated with @bind. <".concat(t,"> is not a method!"));return{configurable:!0,get:function(){var e,r=null===(e=n.value)||void 0===e?void 0:e.bind(this);return Object.defineProperty(this,t,{value:r,configurable:!0,writable:!0}),r}}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o,a,l,u=0,c=function(){function e(t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(r="_score")in this?Object.defineProperty(this,r,{value:0,enumerable:!0,configurable:!0,writable:!0}):this[r]=0,this.name=t,this._id=Symbol("player__".concat(u++)),this._tiles=n}var t,n;return t=e,(n=[{key:"hasEmptyHand",get:function(){return 0===this._tiles}},{key:"id",get:function(){return this._id}},{key:"score",get:function(){return this._score}},{key:"tileCount",get:function(){return this._tiles}},{key:"setTileCount",value:function(e){this._tiles=e}},{key:"updateScore",value:function(e){return this._score+=e,this._score}},{key:"updateTileCount",value:function(e){return this._tiles+=e,this._tiles}}])&&i(t.prototype,n),e}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y,d,p,h,v,b,m,g,P,k=Symbol("singleton"),w=(l=a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"activeIndex",null),f(this,"_activePlayer",null),f(this,"_players",[]),t!==k)throw"Use the static property instance to get the PlayerManager"}var t,n,r;return t=e,r=[{key:"instance",get:function(){return null===e._instance&&(e._instance=new e(k)),e._instance}}],(n=[{key:"activePlayer",get:function(){return this.createPlayerSummary(this._activePlayer)}},{key:"firstRankedPlayer",get:function(){var e=this._players.reduce((function(e,t){return t.score>e.score?t:e}),{score:-1/0});return this.createPlayerSummary(e)}},{key:"players",get:function(){return this._players.map(this.createPlayerSummary)}},{key:"createPlayerSummary",value:function(e){var t;return{hasEmptyHand:e.hasEmptyHand,id:e.id,isActive:(null===(t=this._activePlayer)||void 0===t?void 0:t.id)===e.id,name:e.name,score:e.score,tileCount:e.tileCount}}},{key:"activateNextPlayer",value:function(){return this.activeIndex=(this.activeIndex+1)%this._players.length,this._activePlayer=this._players[this.activeIndex],this.players[this.activeIndex]}},{key:"createPlayers",value:function(e,t){this.activeIndex=null,this._activePlayer=null,this._players=e.map((function(e){return new c(e,t)}))}},{key:"setActivePlayer",value:function(e){return this.activeIndex=this._players.findIndex((function(t){return t.id===e})),this._activePlayer=this._players[this.activeIndex],this.players[this.activeIndex]}},{key:"resetTileCount",value:function(e){this._players.forEach((function(t){return t.setTileCount(e)}))}},{key:"updateActivePlayerScore",value:function(e){return this._activePlayer.updateScore(e)}},{key:"updateActivePlayerTileCount",value:function(e){return this._activePlayer.updateTileCount(e)}},{key:"updatePlayerScore",value:function(e,t){var n=this._players.find((function(t){return t.id===e}));return null==n?void 0:n.updateScore(t)}}])&&s(t.prototype,n),r&&s(t,r),e}(),f(a,"_instance",null),y=(o=l).prototype,d="createPlayerSummary",p=[r],h=Object.getOwnPropertyDescriptor(o.prototype,"createPlayerSummary"),v=o.prototype,b={},Object.keys(h).forEach((function(e){b[e]=h[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=p.slice().reverse().reduce((function(e,t){return t(y,d,e)||e}),b),v&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(v):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(y,d,b),b=null),o);function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.Default="default",e.Collection="collection",e.RoundStart="round-start"}(m||(m={})),function(e){e.Bridge="bridge",e.DoubleSided="double-sided",e.Hexagon="hexagon"}(g||(g={}));var _=[9,7,7,6,6],O=(S(P={},g.Bridge,40),S(P,g.DoubleSided,40),S(P,g.Hexagon,50),P);function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C,T={id:Symbol("dummy"),points:1/0};function E(e){switch(e.turnType){case m.Default:return function(e){var t,n,r,i,o=0===e.points&&3===e.tilesDrawn?-10:0;return(null!==(t=e.points)&&void 0!==t?t:0)+(r=e.completedShape,null!==(i=O[r])&&void 0!==i?i:0)+-5*(null!=(n=e.tilesDrawn)?n:0)+o}(e);case m.RoundStart:return function(e){var t,n=null!==(t=e.points)&&void 0!==t?t:0;return n+(e.isTriple?0===n?40:10:0)}(e);default:return 0}}function R(e){var t,n;return(0===(null!==(t=e.points)&&void 0!==t?t:0)?0:-1)+(null!==(n=e.tilesDrawn)&&void 0!==n?n:0)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=".js-".concat("dialog"),z="is-visible",D={closeTrigger:"".concat(I,"__close"),container:"".concat(I,"__container"),portal:"#dialog-portal"},A=(function(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setup()}var t,n;return t=e,(n=[{key:"dialogContent",get:function(){return this.container}},{key:"onClose",value:function(){this.hideDialog()}},{key:"bindCloseEvent",value:function(){var e,t=null===(e=this.container)||void 0===e?void 0:e.querySelector(D.closeTrigger);null==t||t.addEventListener("click",this.onClose)}},{key:"fillPlaceholders",value:function(e,t){Object.keys(t).forEach((function(n){var r=e.querySelector('[data-placeholder="'.concat(n,'"]'));null!==r&&(r.textContent=t[n])}))}},{key:"getDialogContent",value:function(e){var t,n=document.getElementById("dialog-".concat(e));return null!==(t=null==n?void 0:n.content.firstElementChild.cloneNode(!0))&&void 0!==t?t:null}},{key:"setup",value:function(){var e;this.portal=document.querySelector(D.portal),this.container=null===(e=this.portal)||void 0===e?void 0:e.querySelector(D.container)}},{key:"hideDialog",value:function(){var e;this.portal.classList.remove(z),this.container.removeChild(this.container.firstElementChild),null===(e=this.closeCallback)||void 0===e||e.call(this),this.closeCallback=null}},{key:"showDialog",value:function(e,t){var n;this.closeCallback=t.onClose;var r=this.getDialogContent(e);t.placeholders&&this.fillPlaceholders(r,t.placeholders),this.container.appendChild(r),this.bindCloseEvent(),null===(n=t.onBeforeShow)||void 0===n||n.call(t,this.container),this.portal.classList.add(z)}}])&&x(t.prototype,n),e}()).prototype,"onClose",[r],Object.getOwnPropertyDescriptor(C.prototype,"onClose"),C.prototype),C);function L(e,t,n){var r=n?"add":"remove";e.classList[r](t)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B,V=".js-".concat("header"),N="c-header--has-subtitle",H={subtitle:"".concat(V,"__subtitle"),title:"".concat(V,"__title")},W=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setup()}var t,n;return t=e,(n=[{key:"hasSubtitle",get:function(){return void 0!==this.subtitle}},{key:"subtitle",get:function(){var e,t=null===(e=this._subtitle)||void 0===e?void 0:e.textContent;return""===t?void 0:t},set:function(e){this.updateSubtitle(e)}},{key:"title",get:function(){var e;return null===(e=this._title)||void 0===e?void 0:e.textContent},set:function(e){null!==this._title&&(this._title.textContent=e)}},{key:"setup",value:function(){this._subtitle=this.base.querySelector(H.subtitle),this._title=this.base.querySelector(H.title),L(this.base,N,this.hasSubtitle)}},{key:"updateSubtitle",value:function(e){null!==this._subtitle&&(this._subtitle.textContent=null!=e?e:"",L(this.base,N,this.hasSubtitle))}},{key:"clearSubtitle",value:function(){this.subtitle=void 0}}])&&q(t.prototype,n),e}();function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var U=".js-".concat("footer"),G={buttonPrimary:"".concat(U,"__primary"),buttonSecondary:"".concat(U,"__secondary")},$=(M((B=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.config=n,this.setup(),this.bindEvents()}var t,n;return t=e,(n=[{key:"bindEvents",value:function(){var e,t;null===(e=this.primaryButton)||void 0===e||e.addEventListener("click",this.onPrimaryButtonClicked),null===(t=this.secondaryButton)||void 0===t||t.addEventListener("click",this.onSecondaryButtonClicked)}},{key:"onPrimaryButtonClicked",value:function(e){var t;null===(t=this.config.onPerformPrimaryAction)||void 0===t||t.call(this)}},{key:"onSecondaryButtonClicked",value:function(e){var t;null===(t=this.config.onPerformSecondaryAction)||void 0===t||t.call(this)}},{key:"setup",value:function(){this.primaryButton=this.base.querySelector(G.buttonPrimary),this.secondaryButton=this.base.querySelector(G.buttonSecondary)}},{key:"primaryEnabled",get:function(){var e,t;return null!==(e=null===(t=this.primaryButton)||void 0===t?void 0:t.disabled)&&void 0!==e&&e},set:function(e){null!==this.primaryButton&&(this.primaryButton.disabled=!e)}},{key:"secondaryEnabled",get:function(){var e,t;return null!==(e=null===(t=this.secondaryButton)||void 0===t?void 0:t.disabled)&&void 0!==e&&e},set:function(e){null!==this.secondaryButton&&(this.secondaryButton.disabled=!e)}}])&&F(t.prototype,n),e}()).prototype,"onPrimaryButtonClicked",[r],Object.getOwnPropertyDescriptor(B.prototype,"onPrimaryButtonClicked"),B.prototype),M(B.prototype,"onSecondaryButtonClicked",[r],Object.getOwnPropertyDescriptor(B.prototype,"onSecondaryButtonClicked"),B.prototype),B);function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setupBase()}var t,n;return t=e,(n=[{key:"isVisible",get:function(){return!this.base.hidden},set:function(e){this.base.hidden=!e}},{key:"onSecondaryAction",value:function(){}},{key:"onPrimaryAction",value:function(){}},{key:"setupBase",value:function(){var e=this,t=this.base.querySelector(V),n=this.base.querySelector(U);null!==t&&(this.header=new W(t)),null!==n&&(this.footer=new $(n,{onPerformPrimaryAction:function(){return e.onPrimaryAction()},onPerformSecondaryAction:function(){return e.onSecondaryAction()}}))}}])&&J(t.prototype,n),e}();function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=".js-".concat("player-input"),Y=("".concat(X,"__form"),"input"),Z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t}var t,n;return t=e,(n=[{key:"playerNames",get:function(){return this.getPlayerNames()}},{key:"getPlayerNames",value:function(){var e=this.base.querySelectorAll(Y);return Array.from(e).map((function(e){return e.value.trim()})).filter((function(e){return""!==e}))}}])&&Q(t.prototype,n),e}();function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re={messageSelector:".js-message",scrollToVisible:!0};function ie(e,t,n){var r=te(te({},re),n),i=Array.from(e.querySelectorAll(r.messageSelector));if(i.forEach((function(e){e.hidden=!t.includes(e.id)})),r.scrollToVisible){var o=i.find((function(e){return!e.hidden}));null==o||o.scrollIntoView({behavior:"smooth"})}}function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ce(r);if(i){var n=ce(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ue(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onPrimaryAction",value:function(){var e,t,n,r=null!==(e=null===(t=this.playerInput)||void 0===t?void 0:t.playerNames)&&void 0!==e?e:[],i=r.length>=2;this.updateWarningVisibility(i),i&&(null===(n=this.config.onPlayersSelected)||void 0===n||n.call(this,r))}},{key:"setup",value:function(){var e=this.base.querySelector(X);e&&(this.playerInput=new Z(e))}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.warningId];ie(this.base,t)}}])&&ae(t.prototype,n),a}(K);function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pe(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=he(r);if(i){var n=he(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return pe(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"round",get:function(){return this._round},set:function(e){e!==this._round&&Number.isFinite(e)&&(this._round=e,this.updateHeader())}},{key:"onSecondaryAction",value:function(){var e;null===(e=this.config.onCancel)||void 0===e||e.call(this)}},{key:"onPrimaryAction",value:function(){var e,t=this.getSelectedPlayer(),n=null!==t;this.updateWarningVisibility(n),n&&(null===(e=this.config.onPlayerSelected)||void 0===e||e.call(this,t))}},{key:"getSelectedPlayer",value:function(){var e=this.base.querySelector('input[type="radio"]:checked');return null===e?null:this.players.find((function(t){return t.id===e.id})).summary}},{key:"renderPlayer",value:function(e){return'<li class="c-radio-button">\n\t\t\t<input class="c-radio-button__input" type="radio" name="player-select" id="'.concat(e.id,'">\n\t\t\t<label for="').concat(e.id,'" class="c-radio-button__button">\n\t\t\t\t').concat(e.summary.name,"\n\t\t\t</label>\n\t\t</li>")}},{key:"renderPlayersList",value:function(){var e=this,t=this.base.querySelector(this.config.selectors.nameList);null!==t&&(t.innerHTML=this.players.map((function(t){return e.renderPlayer(t)})).join(""))}},{key:"setup",value:function(){this.isVisible=this.config.isVisible}},{key:"updateHeader",value:function(){this.header.title="Start Round ".concat(this.round).trim()}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.warningId];ie(this.base,t)}},{key:"setPlayers",value:function(e){this.players=e.map((function(e,t){return{id:"player_".concat(t),summary:e}})),this.renderPlayersList()}}])&&ye(t.prototype,n),a}(K);function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var me,ge="is-visible",Pe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t}var t,n;return t=e,(n=[{key:"hide",value:function(){this.base.classList.remove(ge)}},{key:"show",value:function(){this.base.classList.add(ge)}}])&&be(t.prototype,n),e}();function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}".js-".concat("number-pad");var we,Se="data-action",_e="data-value",Oe={button:"[".concat(Se,"], [").concat(_e,"]")},je=(function(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((me=function(){function e(t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(r="_value")in this?Object.defineProperty(this,r,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[r]="",this.base=t,this.callback=n,this.bindEvents()}var t,n;return t=e,(n=[{key:"value",get:function(){return""===this._value?void 0:parseInt(this._value,10)},set:function(e){Number.isFinite(e)&&(this._value=e.toString())}},{key:"bindEvents",value:function(){this.base.addEventListener("click",this.onClick)}},{key:"onClick",value:function(e){var t=e.target.closest(Oe.button);null!==t&&(t.hasAttribute(Se)?this.processAction(t.getAttribute(Se)):this.processValue(t.getAttribute(_e)))&&this.callback&&this.callback(this.value)}},{key:"processAction",value:function(e){if(""===this._value)return!1;switch(e){case"backspace":return this._value=this._value.slice(0,-1),!0;case"clear":return this.reset(),!0;default:return!1}}},{key:"processValue",value:function(e){return this._value+=e,!0}},{key:"reset",value:function(){this._value=""}}])&&ke(t.prototype,n),e}()).prototype,"onClick",[r],Object.getOwnPropertyDescriptor(me.prototype,"onClick"),me.prototype),me);function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Te,Ee=(function(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((we=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.configuration=n,this.setup()}var t,n;return t=e,(n=[{key:"value",get:function(){return this.numberPad.value},set:function(e){this.numberPad.value=e,this.showPoints(e)}},{key:"onPointsChanged",value:function(e){var t,n;this.showPoints(e),null===(t=(n=this.configuration).onPointsChanged)||void 0===t||t.call(n,e)}},{key:"setup",value:function(){this.display=this.base.querySelector(this.configuration.selectors.display);var e=this.base.querySelector(this.configuration.selectors.numberPad);null!==e&&(this.numberPad=new je(e,this.onPointsChanged)),void 0!==this.configuration.defaultPoints&&(this.value=this.configuration.defaultPoints)}},{key:"showPoints",value:function(e){var t;this.display&&(this.display.textContent=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:"0")}},{key:"reset",value:function(){this.value=0}}])&&Ce(t.prototype,n),e}()).prototype,"onPointsChanged",[r],Object.getOwnPropertyDescriptor(we.prototype,"onPointsChanged"),we.prototype),we);function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Le="data-id",qe=(Ae((Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=De(r);if(i){var n=De(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ze(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onClicked",value:function(e){var t,n,r,i=null===(t=e.target.closest("[".concat(Le,"]:not(:disabled)")))||void 0===t?void 0:t.getAttribute(Le);void 0!==i&&(this.selectedPlayer=this.players.find((function(e){return e.id===i})),void 0!==this.selectedPlayer&&(this.numberEntry.value=null!==(n=this.selectedPlayer.points)&&void 0!==n?n:0,this.header.title=this.selectedPlayer.summary.name,this.footer.primaryEnabled=!1,null===(r=this.flyIn)||void 0===r||r.show()))}},{key:"onSetPoints",value:function(){var e;0!==this.numberEntry.value&&(this.selectedPlayer.points=this.numberEntry.value),this.renderPlayersList(),null===(e=this.flyIn)||void 0===e||e.hide(),this.header.title=this.config.translations.headerPrompt,this.footer.primaryEnabled=!0}},{key:"onPrimaryAction",value:function(){var e,t,n=0===this.getPlayersWithoutPoints().length;if(this.updateWarningVisibility(n),n){var r=this.players.map((function(e){var t=e.points;return{id:e.summary.id,points:t}}));null===(e=(t=this.config).onPointsCollected)||void 0===e||e.call(t,r)}}},{key:"getPlayersWithoutPoints",value:function(){return this.players.filter((function(e){var t=e.points,n=e.summary.hasEmptyHand;return 0===(null!=t?t:0)&&!n}))}},{key:"renderPlayer",value:function(e){var t=e.id,n=e.points,r=e.summary,i=r.hasEmptyHand,o=r.name;return'<li>\n\t\t\t<button\n\t\t\t\ttype="button"\n\t\t\t\tclass="o-structure o-structure--vertical-center c-score-button"\n\t\t\t\tdata-id="'.concat(t,'"\n\t\t\t\t').concat(i?"disabled":"",'\n\t\t\t>\n\t\t\t\t<p class="o-structure o-structure--vertical o-structure--grow">\n\t\t\t\t\t<span class="c-score-button__name">').concat(o,"</span>\n\t\t\t\t\t").concat(i?"<span>Round winner</span>":"","\n\t\t\t\t\t").concat(void 0===n?"<span>No points set</span>":"","\n\t\t\t\t</p>\n\t\t\t\t").concat(0===(null!=n?n:0)?"":'<p class="c-score-button__score">'.concat(n,"</p>"),"\n\t\t\t\t").concat(i?"":'<p class="c-score-button__chevron">❯</p>',"\n\t\t\t</button>\n\t\t</li>")}},{key:"renderPlayersList",value:function(){var e=this,t=this.base.querySelector(this.config.selectors.playerList);null!==t&&(t.innerHTML=this.players.map((function(t){return e.renderPlayer(t)})).join(""))}},{key:"setup",value:function(){var e=this.base.querySelector(this.config.selectors.flyOut);null!==e&&(this.flyIn=new Pe(e));var t=this.base.querySelector(this.config.selectors.numberEntry);null!==t&&(this.numberEntry=new Ee(t,{selectors:{display:".js-number-entry__display",numberPad:".js-number-entry__number-pad"}}));var n=this.base.querySelector(this.config.selectors.setPoints);null!==n&&n.addEventListener("click",this.onSetPoints),this.base.addEventListener("click",this.onClicked),this.isVisible=this.config.isVisible}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.warningId];ie(this.base,t)}},{key:"setPlayers",value:function(e){this.players=e.map((function(e,t){return{id:"player_".concat(t),points:e.hasEmptyHand?0:void 0,summary:e}})),this.renderPlayersList()}}])&&xe(t.prototype,n),a}(K)).prototype,"onClicked",[r],Object.getOwnPropertyDescriptor(Te.prototype,"onClicked"),Te.prototype),Ae(Te.prototype,"onSetPoints",[r],Object.getOwnPropertyDescriptor(Te.prototype,"onSetPoints"),Te.prototype),Te);function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function He(e,t){return!t||"object"!==Be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fe,Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=We(r);if(i){var n=We(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return He(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onSecondaryAction",value:function(){var e;null===(e=this.config.onCancel)||void 0===e||e.call(this)}},{key:"onPrimaryAction",value:function(){var e,t=this.config.pointsValidation,n=this.numberEntry.value,r=n>=t.minimum&&n<=t.maximum;this.updateWarningVisibility(r),r&&(null===(e=this.config.onLimitSet)||void 0===e||e.call(this,n))}},{key:"setup",value:function(){this.isVisible=this.config.isVisible;var e=this.base.querySelector(this.config.selectors.numberEntry);null!==e&&(this.numberEntry=new Ee(e,{selectors:{display:".js-number-entry__display",numberPad:".js-number-entry__number-pad"},defaultPoints:this.config.defaultPoints}))}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.pointsValidation.warningId];ie(this.base,t)}}])&&Ve(t.prototype,n),a}(K);function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}".js-".concat("checkbox-group");var Ge,$e=(function(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((Fe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.callback=n,this.bindEvents(),this.setup()}var t,n;return t=e,(n=[{key:"selectedValue",get:function(){var e,t;return null!==(e=null===(t=this.selectedCheckbox)||void 0===t?void 0:t.value)&&void 0!==e?e:void 0}},{key:"bindEvents",value:function(){this.base.addEventListener("change",this.onCheckboxSelected)}},{key:"onCheckboxSelected",value:function(e){var t=e.target;t.checked&&this.selectedCheckbox&&(this.selectedCheckbox.checked=!1),this.selectedCheckbox=t.checked?t:null,this.callback&&this.callback(this.selectedValue)}},{key:"setup",value:function(){this.initialCheckbox=this.base.querySelector("input:checked"),this.selectedCheckbox=this.initialCheckbox}},{key:"reset",value:function(){this.selectedCheckbox!==this.initialCheckbox&&(this.selectedCheckbox&&(this.selectedCheckbox.checked=!1),this.selectedCheckbox=this.initialCheckbox,this.selectedCheckbox&&(this.selectedCheckbox.checked=!0))}}])&&Ue(t.prototype,n),e}()).prototype,"onCheckboxSelected",[r],Object.getOwnPropertyDescriptor(Fe.prototype,"onCheckboxSelected"),Fe.prototype),Fe);function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke,Qe,Xe=".js-".concat("turn-input"),Ye={completedShape:"".concat(Xe,"__completed-shape"),form:"".concat(Xe,"__form"),numberEntry:"".concat(Xe,"__number-entry"),playedTriple:"".concat(Xe,"__played-triple"),playedTripleContainer:"".concat(Xe,"__played-triple-container"),tilesDrawn:"".concat(Xe,"__drawn-tiles")},Ze=(function(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((Ge=function(){function e(t){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r="_turnType",i=m.Default,r in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,this.base=t,this.setup()}var t,n;return t=e,(n=[{key:"hasPlayedTriple",get:function(){var e=this.base.querySelector(Ye.playedTriple);return null!==e&&!e.disabled&&e.checked}},{key:"turn",get:function(){return this.convertInputToObject()}},{key:"turnType",get:function(){return this._turnType},set:function(e){e!==this._turnType&&(this._turnType=e,this.updateVisualState())}},{key:"onPointsChanged",value:function(e){this.turnType===m.RoundStart&&(this.base.querySelector(Ye.playedTriple).disabled=e%3!=0)}},{key:"convertInputToObject",value:function(){var e={completedShape:this.completedShape.selectedValue,turnType:this._turnType};return void 0!==this.numberEntry.value&&(e.points=this.numberEntry.value),this.tilesDrawn.selectedValue&&(e.tilesDrawn=parseInt(this.tilesDrawn.selectedValue,10)),this.hasPlayedTriple&&(e.isTriple=!0),e}},{key:"setup",value:function(){var e=this.base.querySelector(Ye.completedShape),t=this.base.querySelector(Ye.numberEntry),n=this.base.querySelector(Ye.tilesDrawn);null!==e&&(this.completedShape=new $e(e)),null!==t&&(this.numberEntry=new Ee(t,{onPointsChanged:this.onPointsChanged,selectors:{display:".js-number-entry__display",numberPad:".js-number-entry__number-pad"}})),null!==n&&(this.tilesDrawn=new $e(n)),this.updateVisualState()}},{key:"updateVisualState",value:function(){this.completedShape&&(this.completedShape.base.hidden=this.turnType!==m.Default),this.tilesDrawn&&(this.tilesDrawn.base.hidden=this.turnType!==m.Default);var e=this.base.querySelector(Ye.playedTripleContainer);null!==e&&(e.hidden=this.turnType!==m.RoundStart)}},{key:"reset",value:function(){var e,t,n,r=this.base.querySelector(Ye.playedTriple);r&&(r.checked=!1),null===(e=this.completedShape)||void 0===e||e.reset(),null===(t=this.numberEntry)||void 0===t||t.reset(),null===(n=this.tilesDrawn)||void 0===n||n.reset(),this.numberEntry.base.scrollIntoView()}}])&&Je(t.prototype,n),e}()).prototype,"onPointsChanged",[r],Object.getOwnPropertyDescriptor(Ge.prototype,"onPointsChanged"),Ge.prototype),Ge),et=["🥇","🥈","🥉"];function tt(e,t){var n=function(e){var t,n=function(e){if(Array.isArray(e))return j(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return n.sort((function(e,t){return t.score-e.score})),n.map((function(e){return e.id}))}(e),r=e.map((function(e){var r,i=n.findIndex((function(t){return t===e.id})),o=null!==(r=et[i])&&void 0!==r?r:i+1;return"<tr>\n\t\t\t<td>".concat(o,"</td>\n\t\t\t<td>").concat(e.name,"</td>\n\t\t\t<td>").concat(e.score,"</td>\n\t\t\t").concat(t?"<td>".concat(e.tileCount,"</td>"):"","\n\t\t</tr>")})).join("");return"<tbody>\n\t\t".concat(r,"\n\t</tbody>")}function nt(e,t){return'<table class="c-leaderboard">\n\t\t'.concat((n=t.includeTiles,"<thead>\n\t\t<tr>\n\t\t\t<th></th>\n\t\t\t<th>Player</th>\n\t\t\t<th>Score</th>\n\t\t\t".concat(n?"<th>Tiles</th>":"","\n\t\t</tr>\n\t</thead>")),"\n\t\t").concat(tt(e,t.includeTiles),"\n\t</table>");var n}function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function at(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?lt(e):t}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.RoundLocked="round-locked",e.RoundWon="round-won"}(Ke||(Ke={})),function(e){e.Default="default",e.RoundLocked="round-locked",e.RoundStart="round-start",e.RoundWon="round-won"}(Qe||(Qe={}));var st=w.instance,ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ut(r);if(i){var n=ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return at(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ct(lt(n=o.call(this,e)),"maxPassedTurnStreak",0),ct(lt(n),"passedTurnsStreak",0),ct(lt(n),"turnInput",null),n.base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"activePlayer",get:function(){return this._activePlayer},set:function(e){this._activePlayer=e,this.header.title=null==e?void 0:e.name}},{key:"roundType",get:function(){return this._roundType},set:function(e){if(e!==this._roundType)switch(this._roundType=e,e){case Qe.Default:this.turnInput.turnType=m.Default,this.header.subtitle="turn in progress";break;case Qe.RoundStart:this.turnInput.turnType=m.RoundStart,this.header.subtitle="Eerste speelbeurt";break;default:this.turnInput.turnType=m.Collection,this.header.subtitle="collecting points"}}},{key:"onPrimaryAction",value:function(){var e=this.turnInput.turn;this.processPlayerInput(e)}},{key:"onSecondaryAction",value:function(){null!==this.leaderboard&&(this.leaderboard.innerHTML=nt(st.players,{includeTiles:!0}),this.leaderboardFlyout.show())}},{key:"goToNextPlayer",value:function(){this.activePlayer=st.activateNextPlayer(),this.turnInput.reset()}},{key:"processPassedTurn",value:function(){var e,t;this.passedTurnsStreak++,this.passedTurnsStreak!==this.maxPassedTurnStreak?this.goToNextPlayer():null===(e=(t=this.config).onRoundCompleted)||void 0===e||e.call(t,Ke.RoundLocked)}},{key:"processPlayedTurn",value:function(){var e,t;this.passedTurnsStreak=0,this.roundType=Qe.Default,st.activePlayer.hasEmptyHand?null===(e=(t=this.config).onRoundCompleted)||void 0===e||e.call(t,Ke.RoundWon):this.goToNextPlayer()}},{key:"processPlayerInput",value:function(e){var t,n,r=function(e){return{scoreDelta:E(e),tileDelta:R(e)}}(e);st.updateActivePlayerScore(r.scoreDelta),st.updateActivePlayerTileCount(r.tileDelta),null===(t=(n=this.config).onTurnSubmitted)||void 0===t||t.call(n,r),0===e.points?this.processPassedTurn():this.processPlayedTurn()}},{key:"reset",value:function(){this.maxPassedTurnStreak=st.players.length,this.passedTurnsStreak=0,this.turnInput.reset()}},{key:"setup",value:function(){var e=this,t=this.base.querySelector(Xe),n=this.base.querySelector(this.config.selectors.flyOut),r=this.base.querySelector(this.config.selectors.flyOutClose);this.leaderboard=this.base.querySelector(this.config.selectors.leaderboard),null!==Xe&&(this.turnInput=new Ze(t)),null!==n&&(this.leaderboardFlyout=new Pe(n),r.addEventListener("click",(function(){return e.leaderboardFlyout.hide()})))}},{key:"play",value:function(e){this.roundType=e,this.reset()}},{key:"start",value:function(e){this.activePlayer=st.setActivePlayer(e),this.roundType=Qe.RoundStart,this.reset()}}])&&it(t.prototype,n),a}(K);function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t){return(pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ht(e,t){return!t||"object"!==yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bt,mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pt(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vt(r);if(i){var n=vt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ht(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onPrimaryAction",value:function(){var e,t;null===(e=(t=this.config).onStartNewGame)||void 0===e||e.call(t)}},{key:"setup",value:function(){this.board=this.base.querySelector(this.config.selectors.board)}},{key:"showLeaderboard",value:function(e){null!==this.board&&(this.board.innerHTML=nt(e,{includeTiles:!1}))}}])&&dt(t.prototype,n),a}(K);function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pt,kt="is-active",wt=(function(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((bt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.callback=n,this.bindEvents()}var t,n;return t=e,(n=[{key:"bindEvents",value:function(){this.base.addEventListener("transitionend",this.onTimeOut)}},{key:"onTimeOut",value:function(e){var t;"transform"===e.propertyName&&(null===(t=this.callback)||void 0===t||t.call(this))}},{key:"stop",value:function(){this.base.classList.remove(kt)}},{key:"start",value:function(){this.base.classList.add(kt)}}])&&gt(t.prototype,n),e}()).prototype,"onTimeOut",[r],Object.getOwnPropertyDescriptor(bt.prototype,"onTimeOut"),bt.prototype),bt);!function(e){e.Names="names",e.PlayerSelect="player-select",e.PointsLimit="points-limit",e.Round="round",e.Collection="collection",e.Leaderboard="leader-board"}(Pt||(Pt={}));var St={limitReached:!1,pointsLimit:0,round:1,roundReason:Ke.RoundWon,startingPlayer:null,tilesPerRound:0},_t=new A,Ot=w.instance,jt=new n([{id:Pt.Names},{id:Pt.PointsLimit},{id:Pt.PlayerSelect},{id:Pt.Round},{id:Pt.Collection},{id:Pt.Leaderboard}],{instanceFactory:function(e){switch(e){case Pt.Collection:return null===(t=document.querySelector(".js-point-collection"))?null:new qe(t,{isVisible:!1,onPointsCollected:Et,selectors:{flyOut:".js-point-collection__fly-out",numberEntry:".js-point-collection__number-entry",playerList:".js-point-collection__list",setPoints:".js-point-collection__set-points"},translations:{headerPrompt:"Select a player"},warningId:"warning-points-missing"});case Pt.Leaderboard:return function(){var e=document.querySelector(".js-leaderboard");return null===e?null:new mt(e,{onStartNewGame:Dt,selectors:{board:".js-leaderboard__board"}})}();case Pt.Names:return function(){var e=document.querySelector(".js-game-start");return e?new se(e,{onPlayersSelected:Tt,selectors:{form:""},warningId:"warning-required-players"}):null}();case Pt.PlayerSelect:return function(){var e=document.querySelector(".js-player-select");return null===e?null:new ve(e,{isVisible:!1,onCancel:Ct,onPlayerSelected:It,selectors:{nameList:".js-player-select__list"},warningId:"warning-select-starting-player"})}();case Pt.PointsLimit:return function(){var e=document.querySelector(".js-point-limit");return null===e?null:new Me(e,{defaultPoints:200,isVisible:!1,onCancel:Ct,onLimitSet:Rt,pointsValidation:{minimum:100,maximum:1e3,warningId:"warning-invalid-points-limit"},selectors:{numberEntry:".js-point-limit__number-entry"}})}();case Pt.Round:return function(){var e=document.querySelector(".js-round");return null===e?null:new ft(e,{onRoundCompleted:xt,onTurnSubmitted:zt,selectors:{flyOut:".js-round__fly-out",flyOutClose:".js-round__fly-out-close",leaderboard:".js-round__leaderboard"}})}();default:return null}var t},onInstanceActivated:function(e){switch(e.id){case Pt.Collection:e.instance.setPlayers(Ot.players);break;case Pt.Leaderboard:e.instance.showLeaderboard(Ot.players);break;case Pt.PlayerSelect:e.instance.setPlayers(Ot.players),e.instance.round=St.round++;break;case Pt.Round:e.instance.start(St.startingPlayer.id)}}});function Ct(){jt.goBack()}function Tt(e){var t,n;St.tilesPerRound=(t=e.length,n=Math.min(Math.max(0,t-2),4),_[n]),Ot.createPlayers(e,St.tilesPerRound),jt.goForward()}function Et(e){var t,n,r=function(e){var t=e.reduce((function(e,t){return t.points<e.points?t:e}),T),n=e.filter((function(e){return e.id!==t.id})).reduce((function(e,t){return e+t.points}),0);return{id:t.id,points:n-t.points}}(e),i=null!==(t=null===(n=Ot.players.find((function(e){return e.id===r.id})))||void 0===n?void 0:n.name)&&void 0!==t?t:"";Ot.updatePlayerScore(r.id,r.points),function(e,t){_t.showDialog("round-winner",{onClose:function(){St.limitReached?setTimeout(At,0):jt.goTo(Pt.PlayerSelect)},placeholders:{name:t,points:e.toString(10)}})}(r.points,i)}function Rt(e){St.pointsLimit=e,jt.goForward()}function xt(){St.roundReason===Ke.RoundWon&&Ot.updateActivePlayerScore(25),St.limitReached=!1,jt.goForward()}function It(e){St.startingPlayer=e,Ot.resetTileCount(St.tilesPerRound),jt.goForward()}function zt(e){var t=!St.limitReached;St.limitReached=St.limitReached||Ot.activePlayer.score>=St.pointsLimit;var n=t&&St.limitReached?Lt:void 0;!function(e,t){var n="".concat(e>0?"+":"").concat(e);_t.showDialog("turn-played",{onBeforeShow:function(e){var t=e.querySelector(".js-dialog__close");if(null!==t){var n=new wt(t,(function(){return _t.hideDialog()}));setTimeout((function(){return n.start()}),0)}},onClose:t,placeholders:{delta:n,name:Ot.activePlayer.name,score:Ot.activePlayer.score.toString(10)}})}(e.scoreDelta,n)}function Dt(){jt.goTo(Pt.Names)}function At(){var e=Ot.firstRankedPlayer;_t.showDialog("game-winner",{onClose:function(){return jt.goForward()},placeholders:{name:e.name,score:e.score.toString(10)}})}function Lt(){_t.showDialog("last-round",{placeholders:{name:Ot.activePlayer.name,limit:St.pointsLimit.toString(10)}})}})()})();
//# sourceMappingURL=main.3f825cd0.js.map