(()=>{"use strict";(()=>{var e,t,n,i;function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e){e.InProgress="in-progress",e.Locked="locked"}(e||(e={})),function(e){e.Bridge="bridge",e.DoubleSided="double-sided",e.Hexagon="hexagon"}(t||(t={})),function(e){e.Names="names",e.PlayerSelect="player-select",e.PointsLimit="points-limit",e.Round="round",e.Collection="collection",e.Leaderboard="leader-board"}(n||(n={})),function(e){e.Default="default",e.RoundStart="round-start"}(i||(i={}));var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.steps=t,this.config=n,this.setup()}var t,n;return t=e,(n=[{key:"activeIndex",get:function(){var e,t=this;return null===(e=this.steps)||void 0===e?void 0:e.findIndex((function(e){return e.id===t.activeStepId}))}},{key:"activeStep",get:function(){return void 0===this.activeIndex?void 0:this.steps[this.activeIndex]}},{key:"activateStep",value:function(e){var t;this.setVisibility(e,!0),this.activeStepId=e.id,null===(t=this.config.onInstanceActivated)||void 0===t||t.call(this,e)}},{key:"deactivateStep",value:function(e){this.setVisibility(e,!1)}},{key:"getInstance",value:function(e){var t;return e.instance||(e.instance=null!==(t=this.config.instanceFactory(e.id))&&void 0!==t?t:void 0),e.instance}},{key:"setup",value:function(){var e,t,n=(e=this.steps,t=1,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var i,r,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];this.activateStep(n)}},{key:"setVisibility",value:function(e,t){var n=this.getInstance(e);return!!n&&(n.isVisible=t,!0)}},{key:"goBack",value:function(){var e=this.activeIndex;void 0!==e&&0!==e&&(this.deactivateStep(this.steps[e]),this.activateStep(this.steps[e-1]))}},{key:"goForward",value:function(){var e=this.activeIndex;void 0!==e&&e!==this.steps.length-11&&(this.deactivateStep(this.steps[e]),this.activateStep(this.steps[e+1]))}},{key:"goTo",value:function(e){var t=this.steps.find((function(t){return t.id===e}));void 0!==t&&(this.deactivateStep(this.steps[this.activeIndex]),this.activateStep(t))}}])&&o(t.prototype,n),e}();function l(e,t,n){if(!n||"function"!=typeof n.value)throw new TypeError("Only methods can be decorated with @bind. <".concat(t,"> is not a method!"));return{configurable:!0,get:function(){var e,i=null===(e=n.value)||void 0===e?void 0:e.bind(this);return Object.defineProperty(this,t,{value:i,configurable:!0,writable:!0}),i}}}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c,s,f,d=0,y=function(){function e(t,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i="_score")in this?Object.defineProperty(this,i,{value:0,enumerable:!0,configurable:!0,writable:!0}):this[i]=0,this.name=t,this._id=Symbol("player__".concat(d++)),this._tiles=n}var t,n;return t=e,(n=[{key:"hasEmptyHand",get:function(){return 0===this._tiles}},{key:"id",get:function(){return this._id}},{key:"score",get:function(){return this._score}},{key:"tileCount",get:function(){return this._tiles}},{key:"setTileCount",value:function(e){this._tiles=e}},{key:"updateScore",value:function(e){return this._score+=e,this._score}},{key:"updateTileCount",value:function(e){return this._tiles+=e,this._tiles}}])&&u(t.prototype,n),e}();function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v,b,m,g,k,P,w,S=Symbol("singleton"),O=(f=s=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"activeIndex",null),p(this,"_activePlayer",null),p(this,"_players",[]),t!==S)throw"Use the static property instance to get the PlayerManager"}var t,n,i;return t=e,i=[{key:"instance",get:function(){return null===e._instance&&(e._instance=new e(S)),e._instance}}],(n=[{key:"activePlayer",get:function(){return null===this._activePlayer?null:this.createPlayerSummary(this._activePlayer)}},{key:"firstRankedPlayer",get:function(){var e=this._players.reduce((function(e,t){return t.score>e.score?t:e}),{score:-1/0});return this.createPlayerSummary(e)}},{key:"numberOfPlayers",get:function(){return this._players.length}},{key:"players",get:function(){return this._players.map(this.createPlayerSummary)}},{key:"createPlayerSummary",value:function(e){var t;return{hasEmptyHand:e.hasEmptyHand,id:e.id,isActive:(null===(t=this._activePlayer)||void 0===t?void 0:t.id)===e.id,name:e.name,score:e.score,tileCount:e.tileCount}}},{key:"activateNextPlayer",value:function(){return null===this.activeIndex?null:(this.activeIndex=(this.activeIndex+1)%this._players.length,this._activePlayer=this._players[this.activeIndex],this.players[this.activeIndex])}},{key:"createPlayers",value:function(e,t){this.activeIndex=null,this._activePlayer=null,this.tilesPerRound=t,this._players=e.map((function(e){return new y(e,t)}))}},{key:"setActivePlayer",value:function(e){return this.activeIndex=this._players.findIndex((function(t){return t.id===e})),this._activePlayer=this._players[this.activeIndex],this.players[this.activeIndex]}},{key:"resetTileCount",value:function(){var e=this;this._players.forEach((function(t){var n;return t.setTileCount(null!==(n=e.tilesPerRound)&&void 0!==n?n:0)}))}},{key:"updateActivePlayerScore",value:function(e){var t,n;return null!==(t=null===(n=this._activePlayer)||void 0===n?void 0:n.updateScore(e))&&void 0!==t?t:0}},{key:"updateActivePlayerTileCount",value:function(e){var t,n;return null!==(t=null===(n=this._activePlayer)||void 0===n?void 0:n.updateTileCount(e))&&void 0!==t?t:0}},{key:"updatePlayerScore",value:function(e,t){var n,i=this._players.find((function(t){return t.id===e}));return null!==(n=null==i?void 0:i.updateScore(t))&&void 0!==n?n:0}}])&&h(t.prototype,n),i&&h(t,i),e}(),p(s,"_instance",null),v=(c=f).prototype,b="createPlayerSummary",m=[l],g=Object.getOwnPropertyDescriptor(c.prototype,"createPlayerSummary"),k=c.prototype,P={},Object.keys(g).forEach((function(e){P[e]=g[e]})),P.enumerable=!!P.enumerable,P.configurable=!!P.configurable,("value"in P||P.initializer)&&(P.writable=!0),P=m.slice().reverse().reduce((function(e,t){return t(v,b,e)||e}),P),k&&void 0!==P.initializer&&(P.value=P.initializer?P.initializer.call(k):void 0,P.initializer=void 0),void 0===P.initializer&&(Object.defineProperty(v,b,P),P=null),c);function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=[9,7,7,6,6],T=(_(w={},t.Bridge,40),_(w,t.DoubleSided,40),_(w,t.Hexagon,50),w);function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var E={id:Symbol("dummy"),points:1/0};function I(e){switch(e.turnType){case i.Default:return function(e){var t,n,i,r=void 0===e.points?-10:0;return(null!==(t=e.points)&&void 0!==t?t:0)+(void 0===(i=e.completedShape)?0:T[i])+-5*(null!=(n=e.tilesDrawn)?n:0)+r}(e);case i.RoundStart:return function(e){var t,n=null!==(t=e.points)&&void 0!==t?t:0;return n+(e.isTriple?0===n?40:10:0)}(e);default:return 0}}function x(e){var t;return(void 0===e.points?0:-1)+(null!==(t=e.tilesDrawn)&&void 0!==t?t:0)}function z(e,t,n){var i=n?"add":"remove";e.classList[i](t)}function R(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var L,D=".js-".concat("header"),A="c-header--has-subtitle",q={subtitle:"".concat(D,"__subtitle"),title:"".concat(D,"__title")},B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setup()}var t,n;return t=e,(n=[{key:"hasSubtitle",get:function(){return void 0!==this.subtitle}},{key:"subtitle",get:function(){var e,t=null===(e=this._subtitle)||void 0===e?void 0:e.textContent;return""===t?void 0:t},set:function(e){this.updateSubtitle(e)}},{key:"title",get:function(){var e;return null===(e=this._title)||void 0===e?void 0:e.textContent},set:function(e){null!==this._title&&(this._title.textContent=e)}},{key:"setup",value:function(){this._subtitle=this.base.querySelector(q.subtitle),this._title=this.base.querySelector(q.title),z(this.base,A,this.hasSubtitle)}},{key:"updateSubtitle",value:function(e){null!==this._subtitle&&(this._subtitle.textContent=null!=e?e:"",z(this.base,A,this.hasSubtitle))}},{key:"clearSubtitle",value:function(){this.subtitle=void 0}}])&&R(t.prototype,n),e}();function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function F(e,t,n,i,r){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var H=".js-".concat("footer"),N={buttonPrimary:"".concat(H,"__primary"),buttonSecondary:"".concat(H,"__secondary")},W=(F((L=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.config=n,this.setup(),this.bindEvents()}var t,n;return t=e,(n=[{key:"bindEvents",value:function(){var e,t;null===(e=this.primaryButton)||void 0===e||e.addEventListener("click",this.onPrimaryButtonClicked),null===(t=this.secondaryButton)||void 0===t||t.addEventListener("click",this.onSecondaryButtonClicked)}},{key:"onPrimaryButtonClicked",value:function(e){var t;null===(t=this.config.onPerformPrimaryAction)||void 0===t||t.call(this)}},{key:"onSecondaryButtonClicked",value:function(e){var t;null===(t=this.config.onPerformSecondaryAction)||void 0===t||t.call(this)}},{key:"setup",value:function(){this.primaryButton=this.base.querySelector(N.buttonPrimary),this.secondaryButton=this.base.querySelector(N.buttonSecondary)}},{key:"primaryEnabled",get:function(){var e,t;return null!==(e=null===(t=this.primaryButton)||void 0===t?void 0:t.disabled)&&void 0!==e&&e},set:function(e){null!==this.primaryButton&&(this.primaryButton.disabled=!e)}},{key:"secondaryEnabled",get:function(){var e,t;return null!==(e=null===(t=this.secondaryButton)||void 0===t?void 0:t.disabled)&&void 0!==e&&e},set:function(e){null!==this.secondaryButton&&(this.secondaryButton.disabled=!e)}},{key:"secondaryTitle",get:function(){var e,t;return null!==(e=null===(t=this.secondaryButton)||void 0===t?void 0:t.textContent)&&void 0!==e?e:""},set:function(e){null!==this.secondaryButton&&(this.secondaryButton.textContent=e)}}])&&V(t.prototype,n),e}()).prototype,"onPrimaryButtonClicked",[l],Object.getOwnPropertyDescriptor(L.prototype,"onPrimaryButtonClicked"),L.prototype),F(L.prototype,"onSecondaryButtonClicked",[l],Object.getOwnPropertyDescriptor(L.prototype,"onSecondaryButtonClicked"),L.prototype),L);function M(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setupBase()}var t,n;return t=e,(n=[{key:"isVisible",get:function(){return!this.base.hidden},set:function(e){this.base.hidden=!e}},{key:"secondaryActionTitle",get:function(){return this.footer.secondaryTitle},set:function(e){this.footer.secondaryTitle=e}},{key:"onSecondaryAction",value:function(){}},{key:"onPrimaryAction",value:function(){}},{key:"setupBase",value:function(){var e=this,t=this.base.querySelector(D),n=this.base.querySelector(H);null!==t&&(this.header=new B(t)),null!==n&&(this.footer=new W(n,{onPerformPrimaryAction:function(){return e.onPrimaryAction()},onPerformSecondaryAction:function(){return e.onSecondaryAction()}}))}}])&&M(t.prototype,n),e}();function G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $=".js-".concat("player-input"),J=("".concat($,"__form"),"input"),K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t}var t,n;return t=e,(n=[{key:"playerNames",get:function(){return this.getPlayerNames()}},{key:"getPlayerNames",value:function(){var e=this.base.querySelectorAll(J);return Array.from(e).map((function(e){return e.value.trim()})).filter((function(e){return""!==e}))}}])&&G(t.prototype,n),e}();function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z={messageSelector:".js-message",scrollToVisible:!0};function ee(e,t,n){var i=X(X({},Z),n),r=Array.from(e.querySelectorAll(i.messageSelector));if(r.forEach((function(e){e.hidden=!t.includes(e.id)})),i.scrollToVisible){var o=r.find((function(e){return!e.hidden}));null==o||o.scrollIntoView({behavior:"smooth"})}}function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e,t){return!t||"object"!==te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(a,e);var t,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oe(i);if(r){var n=oe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return re(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onPrimaryAction",value:function(){var e,t,n,i=null!==(e=null===(t=this.playerInput)||void 0===t?void 0:t.playerNames)&&void 0!==e?e:[],r=i.length>=2;this.updateWarningVisibility(r),r&&(null===(n=this.config.onPlayersSelected)||void 0===n||n.call(this,i))}},{key:"setup",value:function(){var e=this.base.querySelector($);e&&(this.playerInput=new K(e))}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.warningId];ee(this.base,t)}}])&&ne(t.prototype,n),a}(U),le=["ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰"];function ue(e,t){var n=function(e){var t,n=function(e){if(Array.isArray(e))return C(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return n.sort((function(e,t){return t.score-e.score})),n.map((function(e){return e.id}))}(e),i=e.map((function(e){var i,r=n.findIndex((function(t){return t===e.id})),o=null!==(i=le[r])&&void 0!==i?i:r+1;return"<tr>\n\t\t\t<td>".concat(o,"</td>\n\t\t\t<td>").concat(e.name,"</td>\n\t\t\t<td>").concat(e.score,"</td>\n\t\t\t").concat(t?"<td>".concat(e.tileCount,"</td>"):"","\n\t\t</tr>")})).join("");return"<tbody>\n\t\t".concat(i,"\n\t</tbody>")}function ce(e,t){return'<table class="c-leaderboard">\n\t\t'.concat((n=t.includeTiles,"<thead>\n\t\t<tr>\n\t\t\t<th></th>\n\t\t\t<th>Player</th>\n\t\t\t<th>Score</th>\n\t\t\t".concat(n?"<th>Tiles</th>":"","\n\t\t</tr>\n\t</thead>")),"\n\t\t").concat(ue(e,t.includeTiles),"\n\t</table>");var n}function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pe,ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(a,e);var t,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=he(i);if(r){var n=he(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ye(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onPrimaryAction",value:function(){var e,t;null===(e=(t=this.config).onStartNewGame)||void 0===e||e.call(t)}},{key:"setup",value:function(){this.board=this.base.querySelector(this.config.selectors.board)}},{key:"showLeaderboard",value:function(e){null!==this.board&&(this.board.innerHTML=ce(e,{includeTiles:!1}))}}])&&fe(t.prototype,n),a}(U);function be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var me="is-visible",ge=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((pe=function(){function e(t,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i="isVisible")in this?Object.defineProperty(this,i,{value:false,enumerable:!0,configurable:!0,writable:!0}):this[i]=false,this.base=t,this.config=n,this.setup()}var t,n;return t=e,(n=[{key:"background",get:function(){var e;return null===(e=this.config)||void 0===e?void 0:e.background}},{key:"onTransitionEnd",value:function(e){var t,n,i,r;this.isVisible?null===(t=this.config)||void 0===t||null===(n=t.onShown)||void 0===n||n.call(t):(this.base.hidden=!0,null===(i=this.config)||void 0===i||null===(r=i.onHidden)||void 0===r||r.call(i))}},{key:"setup",value:function(){this.base.addEventListener("transitionend",this.onTransitionEnd)}},{key:"hide",value:function(){var e;this.isVisible=!1,null===(e=this.background)||void 0===e||e.classList.remove(me),this.base.classList.remove(me)}},{key:"show",value:function(){var e=this;this.isVisible=!0,this.base.hidden=!1,setTimeout((function(){var t;null===(t=e.background)||void 0===t||t.classList.add(me),e.base.classList.add(me)}),0)}}])&&be(t.prototype,n),e}()).prototype,"onTransitionEnd",[l],Object.getOwnPropertyDescriptor(pe.prototype,"onTransitionEnd"),pe.prototype),pe);function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.config=n,this.setup()}var t,n;return t=e,(n=[{key:"setup",value:function(){var e=this;this.board=this.base.querySelector(this.config.selectors.board);var t=this.base.querySelector(this.config.selectors.closeTrigger),n=document.querySelector(this.config.selectors.background);null!==t&&t.addEventListener("click",(function(){var t;null===(t=e.flyOutController)||void 0===t||t.hide()})),this.flyOutController=new ge(this.base,{background:null!=n?n:void 0})}},{key:"showLeaderboard",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0!==this.board&&(this.board.innerHTML=ce(e,{includeTiles:n}),null===(t=this.flyOutController)||void 0===t||t.show())}}])&&ke(t.prototype,n),e}();function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te,Ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(a,e);var t,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=je(i);if(r){var n=je(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _e(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"round",get:function(){return this._round},set:function(e){e!==this._round&&Number.isFinite(e)&&(this._round=e,this.updateHeader())}},{key:"onSecondaryAction",value:function(){var e;null===(e=this.config.onCancel)||void 0===e||e.call(this)}},{key:"onPrimaryAction",value:function(){var e,t=this.getSelectedPlayer(),n=null!==t;this.updateWarningVisibility(n),n&&(null===(e=this.config.onPlayerSelected)||void 0===e||e.call(this,t))}},{key:"getSelectedPlayer",value:function(){var e,t,n=this.base.querySelector('input[type="radio"]:checked');return null===n?null:null!==(e=null===(t=this.players.find((function(e){return e.id===n.id})))||void 0===t?void 0:t.summary)&&void 0!==e?e:null}},{key:"renderPlayer",value:function(e){return'<li class="c-radio-button">\n\t\t\t<input class="c-radio-button__input" type="radio" name="player-select" id="'.concat(e.id,'">\n\t\t\t<label for="').concat(e.id,'" class="c-radio-button__button">\n\t\t\t\t').concat(e.summary.name,"\n\t\t\t</label>\n\t\t</li>")}},{key:"renderPlayersList",value:function(){var e=this,t=this.base.querySelector(this.config.selectors.nameList);null!==t&&(t.innerHTML=this.players.map((function(t){return e.renderPlayer(t)})).join(""))}},{key:"setup",value:function(){this.isVisible=this.config.isVisible}},{key:"updateHeader",value:function(){this.header.title="Start Round ".concat(this.round).trim()}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.warningId];ee(this.base,t)}},{key:"setPlayers",value:function(e){this.players=e.map((function(e,t){return{id:"player_".concat(t),summary:e}})),this.renderPlayersList()}}])&&Se(t.prototype,n),a}(U);function Ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}".js-".concat("number-pad");var Ie,xe="data-action",ze="data-value",Re={button:"[".concat(xe,"], [").concat(ze,"]")},Le=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((Te=function(){function e(t,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i="_value")in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.base=t,this.callback=n,this.bindEvents()}var t,n;return t=e,(n=[{key:"value",get:function(){return""===this._value?void 0:parseInt(this._value,10)},set:function(e){this._value=Number.isFinite(e)?e.toString():""}},{key:"bindEvents",value:function(){this.base.addEventListener("click",this.onClick)}},{key:"onClick",value:function(e){var t=e.target.closest(Re.button);null!==t&&(t.hasAttribute(xe)?this.processAction(t.getAttribute(xe)):this.processValue(t.getAttribute(ze)))&&this.callback&&this.callback(this.value)}},{key:"processAction",value:function(e){if(""===this._value)return!1;switch(e){case"backspace":return this._value=this._value.slice(0,-1),!0;case"clear":return this.reset(),!0;default:return!1}}},{key:"processValue",value:function(e){return this._value+=e,!0}},{key:"reset",value:function(){this._value=""}}])&&Ee(t.prototype,n),e}()).prototype,"onClick",[l],Object.getOwnPropertyDescriptor(Te.prototype,"onClick"),Te.prototype),Te);function De(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ae,qe=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((Ie=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.configuration=n,this.setup()}var t,n;return t=e,(n=[{key:"value",get:function(){var e;return null===(e=this.numberPad)||void 0===e?void 0:e.value},set:function(e){void 0!==this.numberPad&&(this.numberPad.value=e,this.showPoints(e))}},{key:"onPointsChanged",value:function(e){var t,n;this.showPoints(e),null===(t=(n=this.configuration).onPointsChanged)||void 0===t||t.call(n,e)}},{key:"setup",value:function(){this.display=this.base.querySelector(this.configuration.selectors.display);var e=this.base.querySelector(this.configuration.selectors.numberPad);null!==e&&(this.numberPad=new Le(e,this.onPointsChanged)),this.value=this.configuration.defaultPoints}},{key:"showPoints",value:function(e){var t;this.display&&(this.display.textContent=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:"--")}},{key:"reset",value:function(){this.value=this.configuration.defaultPoints}}])&&De(t.prototype,n),e}()).prototype,"onPointsChanged",[l],Object.getOwnPropertyDescriptor(Ie.prototype,"onPointsChanged"),Ie.prototype),Ie);function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function He(e,t){return!t||"object"!==Be(t)&&"function"!=typeof t?Ne(e):t}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ue(e,t,n,i,r){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Ge="data-id",$e=(Ue((Ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(a,e);var t,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=We(i);if(r){var n=We(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return He(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Me(Ne(n=o.call(this,e)),"flyInTitle",null),Me(Ne(n),"numberEntry",null),n.base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onCancelSetPoints",value:function(e){var t;null===(t=this.flyIn)||void 0===t||t.hide()}},{key:"onClicked",value:function(e){var t,n,i=null===(t=e.target.closest("[".concat(Ge,"]:not(:disabled)")))||void 0===t?void 0:t.getAttribute(Ge);void 0!==i&&(this.selectedPlayer=null===(n=this.players)||void 0===n?void 0:n.find((function(e){return e.id===i})),void 0!==this.selectedPlayer&&(this.prepareFlyInView(),this.showFlyIn()))}},{key:"onFlyInHidden",value:function(){this.flyIn&&this.base.appendChild(this.flyIn.base)}},{key:"onSetPoints",value:function(){var e,t,n;0!==(null===(e=this.numberEntry)||void 0===e?void 0:e.value)&&this.selectedPlayer&&(this.selectedPlayer.points=null===(n=this.numberEntry)||void 0===n?void 0:n.value),this.renderPlayersList(),null===(t=this.flyIn)||void 0===t||t.hide()}},{key:"onPrimaryAction",value:function(){var e,t,n,i,r=0===this.getPlayersWithoutPoints().length;if(this.updateWarningVisibility(r),r){var o=null!==(e=null===(t=this.players)||void 0===t?void 0:t.map((function(e){var t=e.points;return{id:e.summary.id,points:null!=t?t:0}})))&&void 0!==e?e:[];null===(n=(i=this.config).onPointsCollected)||void 0===n||n.call(i,o)}}},{key:"getPlayersWithoutPoints",value:function(){return void 0===this.players?[]:this.players.filter((function(e){var t=e.points,n=e.summary.hasEmptyHand;return 0===(null!=t?t:0)&&!n}))}},{key:"renderPlayer",value:function(e){var t=e.id,n=e.points,i=e.summary;return"<li>\n\t\t\t".concat(function(e,t,n){var i=t.hasEmptyHand,r=t.name;return'\n\t\t<button\n\t\t\ttype="button"\n\t\t\tclass="o-structure o-structure--vertical-center c-score-button"\n\t\t\tdata-id="'.concat(e,'"\n\t\t\t').concat(function(e){return e?"disabled":""}(i),'\n\t\t>\n\t\t\t<p class="o-structure o-structure--vertical o-structure--grow">\n\t\t\t\t<span class="c-score-button__name">').concat(r,"</span>\n\t\t\t\t").concat(function(e){return e?"<span>Round winner</span>":""}(i),"\n\t\t\t\t").concat(function(e){return void 0===e?"<span>No points set</span>":""}(n),"\n\t\t\t</p>\n\t\t\t").concat(function(e){return 0===(null!=e?e:0)?"":'<p class="c-score-button__score">'.concat(e,"</p>")}(n),"\n\t\t</button>")}(t,i,n),"\n\t\t</li>")}},{key:"renderPlayersList",value:function(){var e,t=this,n=this.base.querySelector(this.config.selectors.playerList);null!==n&&void 0!==this.players&&(n.innerHTML=null===(e=this.players)||void 0===e?void 0:e.map((function(e){return t.renderPlayer(e)})).join(""))}},{key:"setup",value:function(){this.setupFlyIn();var e=this.base.querySelector(this.config.selectors.numberEntry);this.numberEntry=null===e?null:new qe(e,{defaultPoints:0,selectors:{display:".js-number-entry__display",numberPad:".js-number-entry__number-pad"}}),this.base.addEventListener("click",this.onClicked),this.isVisible=this.config.isVisible}},{key:"prepareFlyInView",value:function(){var e,t,n,i;this.numberEntry&&(this.numberEntry.value=null!==(e=null===(t=this.selectedPlayer)||void 0===t?void 0:t.points)&&void 0!==e?e:0),this.flyInTitle&&(this.flyInTitle.textContent=null!==(n=null===(i=this.selectedPlayer)||void 0===i?void 0:i.summary.name)&&void 0!==n?n:"")}},{key:"setupFlyIn",value:function(){var e,t,n=this.base.querySelector(this.config.selectors.flyOut);null!==n&&(this.flyIn=new ge(n,{background:this.config.flyInBackground,onHidden:this.onFlyInHidden}),this.flyInTitle=this.base.querySelector(this.config.selectors.flyInTitle),null===(e=this.base.querySelector(this.config.selectors.setPoints))||void 0===e||e.addEventListener("click",this.onSetPoints),null===(t=this.base.querySelector(this.config.selectors.cancelSetPoints))||void 0===t||t.addEventListener("click",this.onCancelSetPoints))}},{key:"showFlyIn",value:function(){var e;void 0!==this.flyIn&&(null===(e=document.querySelector(this.config.selectors.flyInPortal))||void 0===e||e.appendChild(this.flyIn.base),this.flyIn.show())}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.warningId];ee(this.base,t)}},{key:"setPlayers",value:function(e){this.players=e.map((function(e,t){return{id:"player_".concat(t),points:e.hasEmptyHand?0:void 0,summary:e}})),this.renderPlayersList()}}])&&Ve(t.prototype,n),a}(U)).prototype,"onCancelSetPoints",[l],Object.getOwnPropertyDescriptor(Ae.prototype,"onCancelSetPoints"),Ae.prototype),Ue(Ae.prototype,"onClicked",[l],Object.getOwnPropertyDescriptor(Ae.prototype,"onClicked"),Ae.prototype),Ue(Ae.prototype,"onFlyInHidden",[l],Object.getOwnPropertyDescriptor(Ae.prototype,"onFlyInHidden"),Ae.prototype),Ue(Ae.prototype,"onSetPoints",[l],Object.getOwnPropertyDescriptor(Ae.prototype,"onSetPoints"),Ae.prototype),Ae);function Je(e){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xe(e,t){return!t||"object"!==Je(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ze,et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(a,e);var t,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ye(i);if(r){var n=Ye(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Xe(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,e)).base=e,n.config=t,n.setup(),n}return t=a,(n=[{key:"onSecondaryAction",value:function(){var e;null===(e=this.config.onCancel)||void 0===e||e.call(this)}},{key:"onPrimaryAction",value:function(){var e,t,n,i=this.config.pointsValidation,r=null!==(e=null===(t=this.numberEntry)||void 0===t?void 0:t.value)&&void 0!==e?e:0,o=r>=i.minimum&&r<=i.maximum;this.updateWarningVisibility(o),o&&(null===(n=this.config.onLimitSet)||void 0===n||n.call(this,r))}},{key:"setup",value:function(){this.isVisible=this.config.isVisible;var e=this.base.querySelector(this.config.selectors.numberEntry);null!==e&&(this.numberEntry=new qe(e,{defaultPoints:this.config.defaultPoints,selectors:{display:".js-number-entry__display",numberPad:".js-number-entry__number-pad"}}))}},{key:"updateWarningVisibility",value:function(e){var t=e?[]:[this.config.pointsValidation.warningId];ee(this.base,t)}},{key:"reset",value:function(){var e;null===(e=this.numberEntry)||void 0===e||e.reset()}}])&&Ke(t.prototype,n),a}(U);function tt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var it,rt=".js-".concat("dialog"),ot="is-visible",at={closeTrigger:"".concat(rt,"__close"),container:"".concat(rt,"__container"),portal:"#dialog-portal"},lt=at.closeTrigger,ut=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((Ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),nt(this,"container",null),nt(this,"portal",null),this.setup()}var t,n;return t=e,(n=[{key:"dialogContent",get:function(){return this.container}},{key:"onClose",value:function(){this.hideDialog()}},{key:"bindCloseEvent",value:function(){var e,t=null===(e=this.container)||void 0===e?void 0:e.querySelector(at.closeTrigger);null==t||t.addEventListener("click",this.onClose)}},{key:"fillPlaceholders",value:function(e,t){Object.keys(t).forEach((function(n){var i=e.querySelector('[data-placeholder="'.concat(n,'"]'));null!==i&&(i.textContent=t[n])}))}},{key:"getDialogContent",value:function(e){var t,n,i,r=document.getElementById("dialog-".concat(e));return null!==(t=null==r||null===(n=r.content)||void 0===n||null===(i=n.firstElementChild)||void 0===i?void 0:i.cloneNode(!0))&&void 0!==t?t:null}},{key:"setup",value:function(){var e,t;this.portal=document.querySelector(at.portal),this.container=null!==(e=null===(t=this.portal)||void 0===t?void 0:t.querySelector(at.container))&&void 0!==e?e:null}},{key:"hideDialog",value:function(){var e,t,n;null===(e=this.portal)||void 0===e||e.classList.remove(ot),null===(t=this.container)||void 0===t||t.removeChild(this.container.firstElementChild),null===(n=this.closeCallback)||void 0===n||n.call(this),this.closeCallback=void 0}},{key:"showDialog",value:function(e,t){var n,i,r;this.closeCallback=t.onClose;var o=this.getDialogContent(e);t.placeholders&&this.fillPlaceholders(o,t.placeholders),null===(n=this.container)||void 0===n||n.appendChild(o),this.bindCloseEvent(),null===(i=t.onBeforeShow)||void 0===i||i.call(t,this.container),null===(r=this.portal)||void 0===r||r.classList.add(ot)}}])&&tt(t.prototype,n),e}()).prototype,"onClose",[l],Object.getOwnPropertyDescriptor(Ze.prototype,"onClose"),Ze.prototype),Ze);function ct(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var st,ft="is-active",dt=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((it=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.callback=n,this.bindEvents()}var t,n;return t=e,(n=[{key:"bindEvents",value:function(){this.base.addEventListener("transitionend",this.onTimeOut)}},{key:"onTimeOut",value:function(e){var t;"transform"===e.propertyName&&(null===(t=this.callback)||void 0===t||t.call(this))}},{key:"stop",value:function(){this.base.classList.remove(ft)}},{key:"start",value:function(){this.base.classList.add(ft)}}])&&ct(t.prototype,n),e}()).prototype,"onTimeOut",[l],Object.getOwnPropertyDescriptor(it.prototype,"onTimeOut"),it.prototype),it),yt=new ut;function ht(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}".js-".concat("checkbox-group");var pt,vt=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((st=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.callback=n,this.bindEvents(),this.setup()}var t,n;return t=e,(n=[{key:"selectedValue",get:function(){var e,t;return null!==(e=null===(t=this.selectedCheckbox)||void 0===t?void 0:t.value)&&void 0!==e?e:void 0}},{key:"bindEvents",value:function(){this.base.addEventListener("change",this.onCheckboxSelected)}},{key:"onCheckboxSelected",value:function(e){var t=e.target;t.checked&&this.selectedCheckbox&&(this.selectedCheckbox.checked=!1),this.selectedCheckbox=t.checked?t:null,this.callback&&this.callback(this.selectedValue)}},{key:"setup",value:function(){this.initialCheckbox=this.base.querySelector("input:checked"),this.selectedCheckbox=this.initialCheckbox}},{key:"reset",value:function(){this.selectedCheckbox!==this.initialCheckbox&&(this.selectedCheckbox&&(this.selectedCheckbox.checked=!1),this.selectedCheckbox=this.initialCheckbox,this.selectedCheckbox&&(this.selectedCheckbox.checked=!0))}}])&&ht(t.prototype,n),e}()).prototype,"onCheckboxSelected",[l],Object.getOwnPropertyDescriptor(st.prototype,"onCheckboxSelected"),st.prototype),st);function bt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mt=".js-".concat("turn-input"),gt={completedShape:"".concat(mt,"__completed-shape"),form:"".concat(mt,"__form"),numberEntry:"".concat(mt,"__number-entry"),playedTriple:"".concat(mt,"__played-triple"),playedTripleContainer:"".concat(mt,"__played-triple-container"),tilesDrawn:"".concat(mt,"__drawn-tiles")},kt=(function(e,t,n,i,r){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((pt=function(){function e(t){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r="_turnType",o=i.Default,r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this.base=t,this.setup()}var t,n;return t=e,(n=[{key:"hasPlayedTriple",get:function(){var e=this.base.querySelector(gt.playedTriple);return null!==e&&!e.disabled&&e.checked}},{key:"turn",get:function(){return this.convertInputToObject()}},{key:"turnType",get:function(){return this._turnType},set:function(e){e!==this._turnType&&(this._turnType=e,this.updateVisualState())}},{key:"onPointsChanged",value:function(e){this.turnType===i.RoundStart&&(this.base.querySelector(gt.playedTriple).disabled=(null!=e?e:0)%3!=0)}},{key:"convertInputToObject",value:function(){var e={completedShape:this.completedShape.selectedValue,turnType:this._turnType};return void 0!==this.numberEntry.value&&(e.points=this.numberEntry.value),this.tilesDrawn.selectedValue&&(e.tilesDrawn=parseInt(this.tilesDrawn.selectedValue,10)),this.hasPlayedTriple&&(e.isTriple=!0),e}},{key:"setup",value:function(){var e=this.base.querySelector(gt.completedShape),t=this.base.querySelector(gt.numberEntry),n=this.base.querySelector(gt.tilesDrawn);null!==e&&(this.completedShape=new vt(e)),null!==t&&(this.numberEntry=new qe(t,{onPointsChanged:this.onPointsChanged,selectors:{display:".js-number-entry__display",numberPad:".js-number-entry__number-pad"}})),null!==n&&(this.tilesDrawn=new vt(n)),this.updateVisualState()}},{key:"updateVisualState",value:function(){this.completedShape&&(this.completedShape.base.hidden=this.turnType!==i.Default),this.tilesDrawn&&(this.tilesDrawn.base.hidden=this.turnType!==i.Default);var e=this.base.querySelector(gt.playedTripleContainer);null!==e&&(e.hidden=this.turnType!==i.RoundStart)}},{key:"reset",value:function(){var e,t,n,i=this.base.querySelector(gt.playedTriple);i&&(i.checked=!1),null===(e=this.completedShape)||void 0===e||e.reset(),null===(t=this.numberEntry)||void 0===t||t.reset(),null===(n=this.tilesDrawn)||void 0===n||n.reset(),this.numberEntry.base.scrollIntoView()}}])&&bt(t.prototype,n),e}()).prototype,"onPointsChanged",[l],Object.getOwnPropertyDescriptor(pt.prototype,"onPointsChanged"),pt.prototype),pt);function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e,t){return!t||"object"!==Pt(t)&&"function"!=typeof t?_t(e):t}function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ct,Et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=jt(r);if(o){var n=jt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ot(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),Tt(_t(n=a.call(this,e)),"_turnType",i.Default),Tt(_t(n),"turnInput",null),n.base=e,n.config=t,n.setup(),n}return t=l,(n=[{key:"turnType",get:function(){return this._turnType},set:function(e){if(e!==this._turnType)switch(this._turnType=e,e){case i.Default:this.setTurnType(i.Default),this.header.subtitle="turn in progress";break;case i.RoundStart:this.setTurnType(i.RoundStart),this.header.subtitle="initial turn"}}},{key:"onPrimaryAction",value:function(){var e,t,n,i=null===(e=this.turnInput)||void 0===e?void 0:e.turn;null===(t=(n=this.config).onTurnSubmitted)||void 0===t||t.call(n,i)}},{key:"onSecondaryAction",value:function(){var e,t;null===(e=(t=this.config).onShowLeaderboard)||void 0===e||e.call(t)}},{key:"reset",value:function(){var e;null===(e=this.turnInput)||void 0===e||e.reset()}},{key:"setTurnType",value:function(e){null!==this.turnInput&&(this.turnInput.turnType=e)}},{key:"setup",value:function(){var e=this.base.querySelector(mt);null!==mt&&(this.turnInput=new kt(e))}},{key:"play",value:function(e,t){this.header.title=t,this.turnType=e,this.reset()}}])&&wt(t.prototype,n),l}(U);function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){Rt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lt(e,t,n,i,r){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var Dt,At=O.instance,qt=(Lt((Ct=function(){function t(n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rt(this,"maxPassedTurnStreak",0),Rt(this,"passedTurnStreak",0),Rt(this,"status",e.InProgress),this.base=n,this.config=i,this.setup()}var n,r;return n=t,(r=[{key:"canProceedToNextPlayer",get:function(){var t;return this.status===e.InProgress&&!(null!==(t=At.activePlayer)&&void 0!==t&&t.hasEmptyHand)&&this.passedTurnStreak<this.maxPassedTurnStreak}},{key:"isVisible",get:function(){var e,t;return null!==(e=null===(t=this._viewController)||void 0===t?void 0:t.isVisible)&&void 0!==e&&e},set:function(e){void 0!==this._viewController&&(this._viewController.isVisible=e)}},{key:"viewController",get:function(){return this._viewController}},{key:"onShowLeaderboard",value:function(){var e,t;null===(e=(t=this.config).onShowLeaderboard)||void 0===e||e.call(t)}},{key:"onTurnSubmitted",value:function(e){var t,n;this.processTurn(e),this.determineStatus(),null===(t=(n=this.config).onTurnSubmitted)||void 0===t||t.call(n,xt(xt({},e),{},{state:this.status}))}},{key:"determineStatus",value:function(){this.passedTurnStreak===this.maxPassedTurnStreak&&(this.status=e.Locked)}},{key:"goToNextPlayer",value:function(){var e,t,n;return!!this.canProceedToNextPlayer&&(At.activateNextPlayer(),null===(e=this._viewController)||void 0===e||e.play(i.Default,null!==(t=null===(n=At.activePlayer)||void 0===n?void 0:n.name)&&void 0!==t?t:""),!0)}},{key:"processTurn",value:function(e){void 0===e.points?this.passedTurnStreak++:this.passedTurnStreak=0}},{key:"setup",value:function(){this._viewController=new Et(this.base,{onShowLeaderboard:this.onShowLeaderboard,onTurnSubmitted:this.onTurnSubmitted})}},{key:"continueRound",value:function(){return this.goToNextPlayer()}},{key:"startRound",value:function(t){var n,r,o;this.maxPassedTurnStreak=t,this.passedTurnStreak=0,this.status=e.InProgress,null===(n=this.viewController)||void 0===n||n.play(i.RoundStart,null!==(r=null===(o=At.activePlayer)||void 0===o?void 0:o.name)&&void 0!==r?r:"")}}])&&zt(n.prototype,r),t}()).prototype,"onShowLeaderboard",[l],Object.getOwnPropertyDescriptor(Ct.prototype,"onShowLeaderboard"),Ct.prototype),Lt(Ct.prototype,"onTurnSubmitted",[l],Object.getOwnPropertyDescriptor(Ct.prototype,"onTurnSubmitted"),Ct.prototype),Ct),Bt={limitReached:!1,pointsLimit:0,round:1,startingPlayer:null},Vt=O.instance,Ft=new a([{id:n.Names},{id:n.PointsLimit},{id:n.PlayerSelect},{id:n.Round},{id:n.Collection},{id:n.Leaderboard}],{instanceFactory:function(e){switch(e){case n.Collection:return null===(i=document.querySelector(".js-point-collection"))?null:new $e(i,{flyInBackground:null!==(t=document.querySelector("main"))&&void 0!==t?t:void 0,isVisible:!1,onPointsCollected:Wt,selectors:{cancelSetPoints:".js-point-collection__cancel-points",flyOut:".js-point-collection__fly-out",flyInPortal:"#fly-in-portal",flyInTitle:".js-point-collection__fly-out-title",numberEntry:".js-point-collection__number-entry",playerList:".js-point-collection__list",setPoints:".js-point-collection__set-points"},warningId:"warning-points-missing"});case n.Leaderboard:return function(){var e=document.querySelector(".js-leaderboard");return null===e?null:new ve(e,{onStartNewGame:Kt,selectors:{board:".js-leaderboard__board"}})}();case n.Names:return function(){var e=document.querySelector(".js-game-start");return e?new ae(e,{onPlayersSelected:Nt,selectors:{form:""},warningId:"warning-required-players"}):null}();case n.PlayerSelect:return function(){var e=document.querySelector(".js-player-select");return null===e?null:new Ce(e,{isVisible:!1,onCancel:Gt,onPlayerSelected:$t,selectors:{nameList:".js-player-select__list"},warningId:"warning-select-starting-player"})}();case n.PointsLimit:return function(){var e=document.querySelector(".js-point-limit");return null===e?null:new et(e,{defaultPoints:400,isVisible:!1,onCancel:Ht,onLimitSet:Mt,pointsValidation:{minimum:100,maximum:1e3,warningId:"warning-invalid-points-limit"},selectors:{numberEntry:".js-point-limit__number-entry"}})}();case n.Round:return function(){var e=document.querySelector(".js-round");return null===e?null:new qt(e,{onShowLeaderboard:function(){return Xt(!0)},onTurnSubmitted:Jt})}();default:return null}var t,i},onInstanceActivated:function(e){switch(e.id){case n.Collection:e.instance.setPlayers(Vt.players);break;case n.Leaderboard:e.instance.showLeaderboard(Vt.players);break;case n.PlayerSelect:(t=e.instance).setPlayers(Vt.players),t.secondaryActionTitle=Qt()?"Back":"Leaderboard",t.round=Bt.round;break;case n.PointsLimit:e.instance.reset();break;case n.Round:e.instance.startRound(Vt.numberOfPlayers)}var t}});function Ht(){Ft.goBack()}function Nt(e){var t,n,i=(t=e.length,n=Math.min(Math.max(0,t-2),4),j[n]);Vt.createPlayers(e,i),Ft.goForward()}function Wt(e){var t,n,i=function(e){var t=e.reduce((function(e,t){return t.points<e.points?t:e}),E),n=e.filter((function(e){return e.id!==t.id})).reduce((function(e,t){return e+t.points}),0);return{id:t.id,points:n-t.points}}(e),r=null!==(t=null===(n=Vt.players.find((function(e){return e.id===i.id})))||void 0===n?void 0:n.name)&&void 0!==t?t:"";Vt.updatePlayerScore(i.id,i.points),function(e,t,n){yt.showDialog("round-winner",{onClose:n,placeholders:{name:t,points:e.toString(10)}})}(i.points,r,Ut),Bt.round++}function Mt(e){Bt.pointsLimit=e,Bt.limitReached=!1,Ft.goForward()}function Ut(){if(Bt.limitReached){var e=Vt.firstRankedPlayer;setTimeout((function(){return function(e,t){yt.showDialog("game-winner",{onClose:function(){return Ft.goForward()},placeholders:{name:e.name,score:e.score.toString(10)}})}(e)}),0)}else Ft.goTo(n.PlayerSelect)}function Gt(){Qt()?Ft.goBack():Xt()}function $t(e){Bt.startingPlayer=e,Vt.setActivePlayer(e.id),Vt.resetTileCount(),Ft.goForward()}function Jt(t){var n,i,r,o=function(t){var n,i={scoreDelta:I(n=t),tileDelta:x(n)};return Vt.updateActivePlayerScore(i.scoreDelta),Vt.updateActivePlayerTileCount(i.tileDelta),t.state===e.Won&&Vt.updateActivePlayerScore(25),i}(t);if(null!==(n=Vt.activePlayer)&&void 0!==n&&n.hasEmptyHand)Ft.goForward();else{var a=!Bt.limitReached,l=Vt.activePlayer;Bt.limitReached||(Bt.limitReached=(null!==(i=null===(r=Vt.activePlayer)||void 0===r?void 0:r.score)&&void 0!==i?i:0)>=Bt.pointsLimit);var u=a&&Bt.limitReached?function(){return e=l,void setTimeout((function(){return function(e,t,n){yt.showDialog("last-round",{onClose:n,placeholders:{name:e,limit:t.toString(10)}})}(e.name,Bt.pointsLimit,Yt)}),0);var e}:Yt;!function(e,t,n){var i="".concat(t>0?"+":"").concat(t);yt.showDialog("turn-played",{onBeforeShow:function(e){var t=e.querySelector(lt);if(null!==t){var n=new dt(t,(function(){return yt.hideDialog()}));setTimeout((function(){return n.start()}),0)}},onClose:n,placeholders:{delta:i,name:e.name,score:e.score.toString(10)}})}(l,o.scoreDelta,u)}}function Kt(){Ft.goTo(n.Names)}function Qt(){return 1===Bt.round}function Xt(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=Bt.leaderBoardFlyOut)||void 0===e||e.showLeaderboard(Vt.players,t)}function Yt(){var e=Ft.activeStep;void 0!==e&&void 0!==e.instance&&e.instance.continueRound()}null!==(Dt=document.querySelector(".js-leaderboard-fly-out"))&&(Bt.leaderBoardFlyOut=new Pe(Dt,{selectors:{background:"main",board:".js-leaderboard-fly-out__leaderboard",closeTrigger:".js-leaderboard-fly-out__close"}}))})()})();
//# sourceMappingURL=main.f3843c7e.js.map